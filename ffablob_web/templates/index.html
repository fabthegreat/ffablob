{% extends "base.html" %}

{% block titre %}FFABlob<br>#blobez les resultats de vos courses!{% endblock %}

{% block form %}
<div style="margin-bottom:5px">
	<form action="/loadrace" method="get"><!-- Formulaire -->
	    <div class="form-row">
		<div class="col-12 col-md-9 mb-2 mb-md-0">
		    <input type="text" class="form-control form-control-lg" placeholder="Lien de la page de résultat FFA (http://...)" name="urlFFA">
		</div>
		<div class="col-12 col-md-3">
		    <button type="submit" class="btn btn-block btn-lg btn-primary">Chargez la course!</button>
		</div>
	    </div> <!--disposition -->
	</form><!-- Formulaire -->
    Pour rechercher une course, utilisez <a href='http://bases.athle.com/asp.net/accueil.aspx?frmbase=resultats'>le moteur de base athlé FFA.</a>
    <br>
    Le lien doit ressembler au suivant:<br>
    <a href='http://bases.athle.com/asp.net/liste.aspx?frmbase=resultats&frmmode=1&frmespace=0&frmcompetition=207883&frmepreuve=10+km+TC'>http://bases.athle.com/asp.net/liste.aspx?frmbase=resultats&frmmode=1&frmespace=0&frmcompetition=207883&frmepreuve=10+km+TC</a>

	<!-- <form action="/search" method="get">
        <div class="form-row">
		<div class="col-12 col-md-9 mb-2 mb-md-0">
		    <input type="text" class="form-control form-control-lg"
            placeholder="Lancez une recherche de courses par mots clef" name="keywords">
		</div>
		<div class="col-12 col-md-3">
		    <button type="submit" class="btn btn-block btn-lg
                btn-primary">Recherchez!</button>
		</div>
	    </div> 
	</form>

    -->











	{% if error_msg_url %}
		<div class="alert alert-warning" role="alert" style="margin-top:5px;margin-bottom:5px">
			{{ error_msg_url }}
		</div>
	{% endif %}
</div>
{% endblock %}

{% block racecart %}
	{% if racelist %}
		<div class="accordion" id="accordionExample">
		{% for race in racelist %}
				<div class="card">

                        {% include "raceform.html" %}

				</div> 
		{% endfor %}
		</div> 
		<div style='text-align:right;margin:5px'>
		<a href='/flushcart'><span class="badge badge-pill badge-danger">Effacer la liste</span></a>
		</div>
	{% endif %}
{% endblock %}

{% block content %}
		{% if results %}
		Aperçu de la course chargée
		<table class="table" style="margin-top:20px">
			<thead class="thead-dark">
				<tr>
			      		<th scope="col">Classement</th>
                        <th scope="col">Chrono</th>
                        <th scope="col">Coureur</th>
                        <th scope="col">Club</th>
				        <th scope="col">Cat</th>
				        <th scope="col">Sexe</th>
				</tr>
			</thead>
                    <tbody>
                        {% for result in results %}
                        <tr>
                            <th scope="row">{{ result.rstl.0 }} </th>
                            <td>{{ result.rstl.1 }} </td>
                            <td>{{ result.rstl.2 }} </td>
                            <td>{{ result.rstl.4 }} </td>
                            <td>{{ result.rstl.5 }} </td>
                            <td>{{ result.rstl.6 }} </td>
                         </tr>
                        {% endfor %}
		</table>
		{% endif %}

		{% if tab_records %}
        Aperçu de la performance des participants:<br>
        <b>Course</b>: {{ race_recap.name }} (race ID: {{ race_recap.id }})<br>
        <b>Nombre de participants</b>: {{ race_recap.runner_nb }}<br>
		<table class="table" style="margin-top:20px">
			<thead class="thead-dark">
				<tr>
			      		<th scope="col">Classement</th>
                        <th scope="col">Chrono</th>
                        <th scope="col">Coureur</th>
                        <!-- TODO: dates as parameters -->
                        <th scope="col">2018</th>
                        <th scope="col">2017</th>
				        <th scope="col">2016</th>
				        <th scope="col">2015</th>
				</tr>
			</thead>
                    <tbody>
                        {% for record in tab_records %}
                        <tr>
                            <th scope="row">{{ forloop.counter }} </th>
                            <td>{{ record.0 }} </td>
                            <td>{{ record.1 }} </td>
                            <td>{{ record.2.0 }} </td>
                            <td>{{ record.2.1 }} </td>
                            <td>{{ record.2.2 }} </td>
                            <td>{{ record.2.3 }} </td>
                         </tr>
                        {% endfor %}
		</table>
		{% endif %}
{% endblock %}

